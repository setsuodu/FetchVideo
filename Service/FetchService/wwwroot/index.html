<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <title>下载工具</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        body {
            padding: 2rem;
            background: #f8f9fa;
        }

        .card {
            max-width: 600px;
            margin: auto;
        }

        .progress {
            height: 1.5rem;
        }

        #log-image, #log-video {
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
        }

        input::placeholder {
            color: #aaa !important;
            opacity: 1;
        }

        /* 在 index.html 的 <style> 中加入 */
        input.disabled {
            background-color: #e9ecef !important;
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">下载工具</h4>
        </div>
        <div class="card-body">
            <!-- 导航标签 -->
            <ul class="nav nav-tabs mb-3" id="downloadTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="image-tab" data-bs-toggle="tab" data-bs-target="#image-content" type="button" role="tab">连号图片下载</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="video-tab" data-bs-toggle="tab" data-bs-target="#video-content" type="button" role="tab">视频下载</button>
                </li>
            </ul>

            <div class="tab-content" id="downloadTabContent">
                <!-- 图片下载 -->
                <div class="tab-pane fade show active" id="image-content" role="tabpanel">
                    <form id="imageDownloadForm">
                        <div class="mb-3">
                            <label class="form-label">第一张图片 URL</label>
                            <div class="input-group">
                                <input type="url" class="form-control" id="firstUrl" required placeholder="https://x.com/src/img_1.jpg" />
                                <button type="button" class="btn btn-danger d-none" id="clearFirstBtn">×</button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">最后一张图片 URL</label>
                            <div class="input-group">
                                <input type="url" class="form-control" id="lastUrl" required placeholder="https://x.com/src/img_10.jpg" />
                                <button type="button" class="btn btn-danger d-none" id="clearLastBtn">×</button>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">并发数（1~20）<span class="text-muted ms-1">默认 5</span></label>
                            <input type="number" class="form-control" id="concurrency" value="5" min="1" max="20" placeholder="5" />
                        </div>
                        <button type="submit" class="btn btn-success w-100">开始下载</button>
                    </form>

                    <hr />

                    <div id="imageResult" class="d-none">
                        <div class="progress mb-3">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" id="imageProgressBar" style="width: 0%">0%</div>
                        </div>
                        <p id="imageStatus">准备中...</p>
                        <pre id="log-image" class="bg-light p-3 border"></pre>
                        <a id="imageLogLink" class="btn btn-sm btn-outline-secondary d-none" download>下载 404 日志</a>
                    </div>
                </div>

                <!-- 视频下载 -->
                <div class="tab-pane fade" id="video-content" role="tabpanel">
                    <form id="videoDownloadForm">
                        <div class="mb-3">
                            <label class="form-label">视频 URL</label>
                            <div class="input-group">
                                <input type="url" class="form-control" id="videoUrl" required placeholder="https://x.com/src/video.mp4">
                                <button type="button" class="btn btn-danger d-none" id="clearBtn">×</button>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-success w-100">开始下载</button>
                    </form>
                    <hr />
                    <div id="videoResult" class="d-none">
                        <div class="progress mb-3">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" id="videoProgressBar" style="width: 0%">0%</div>
                        </div>
                        <p id="videoStatus">准备中...</p>
                        <pre id="log-video" class="bg-light p-3 border"></pre>
                        <a id="videoLogLink" class="btn btn-sm btn-outline-secondary d-none" download>下载日志</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 模块化 JS -->
    <script type="module" src="js/main.js"></script>
</body>
</html>